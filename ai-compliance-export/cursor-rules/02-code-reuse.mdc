---
alwaysApply: true
---

# üéØ CODE REUSE (MANDATORY)

## üîç SEARCH BEFORE CREATING

**Before creating ANY new code, search for existing implementations in:**

- `src/lib/` - Utility functions
- `src/hooks/` - Custom React hooks  
- `src/components/` - Reusable components
- `src/types/` - Type definitions

---

## üîÑ MIGRATION SOURCE OF TRUTH (CRITICAL - MANDATORY)

**When migrating code from V1 to V2:**

### ‚úÖ ONLY USE `src-v1/` AS SOURCE
- **ONLY** look in `src-v1/` directory for V1 code to migrate
- **ONLY** reference files in `src-v1/app/`, `src-v1/components/`, `src-v1/lib/`, etc.
- **ONLY** use routes, patterns, and structure from `src-v1/`
- **ONLY** match route structure from `src-v1/` (e.g., if `src-v1` has `/settings/eitje-api`, use that exact route)

### ‚ùå NEVER USE THESE FOR MIGRATION:
- ‚ùå `old-supabase-pages-sql-scripts-readonly-dont-use-code-in-rebuild-unless-specifcly-asked-by-me/` - These are archived/old files, NOT source of truth
- ‚ùå Any `old-*` directories - These are not migration sources
- ‚ùå Any files marked as "MIGRATED TO ARCHIVE" - These are old references
- ‚ùå Any other directories - ONLY `src-v1/` is the source of truth

### üìã MIGRATION WORKFLOW:
1. **Find V1 source in `src-v1/`** - This is the ONLY source for V1 code
2. **Match route structure** - Use the exact route from `src-v1/` (e.g., `/settings/eitje-api`)
3. **Match component structure** - Follow patterns from `src-v1/components/`
4. **Match service structure** - Follow patterns from `src-v1/lib/services/`
5. **Match ViewModel structure** - Follow patterns from `src-v1/viewmodels/`

**If you can't find it in `src-v1/`, it doesn't exist for migration purposes. DO NOT search elsewhere.**

**ENFORCEMENT:**
- If user says "migrate from src-v1" or "use src-v1", ONLY look in `src-v1/`
- If user asks about V1 routes/structure, ONLY check `src-v1/`
- NEVER search `old-supabase-pages-sql-scripts-readonly-dont-use-code-in-rebuild-unless-specifcly-asked-by-me/` or other directories when migrating

---

## üì¶ PROJECT UTILITIES

**This project has extensive existing utilities:**

### API Integration:
- `src/lib/eitje/` - Eitje API integration utilities
- `src/lib/bork/` - Bork API integration utilities

### Business Logic:
- `src/lib/finance/` - Finance calculation utilities
- `src/lib/utils.ts` - General utilities

### UI Components:
- `src/components/ui/` - 30+ shadcn/ui components
- `src/components/finance/` - Finance-specific components

### Hooks:
- `src/hooks/` - Custom React hooks

---

## ‚úÖ PRIORITY ORDER

1. **Reuse existing** - Use what's already there
2. **Extend existing** - Add to existing utilities if related
3. **Build new** - Only if nothing exists

**ALWAYS check before creating. Ask user if uncertain about existing code.**

---

**VIOLATIONS:**
- Creating duplicate functionality = compliance violation
- Using wrong migration source (not `src-v1/`) = compliance violation
- Searching `old-supabase-pages-sql-scripts-readonly-dont-use-code-in-rebuild-unless-specifcly-asked-by-me/` or other directories for migration = compliance violation
